# Table of Contents
1. [Generating private and public keys](#gen)
2. [Transferring the file containing your public key to the distant machine](#transfert)
3. [Using the ssh-agent program to type your passphrase only one time](#use)

## Generating private and public keys <a name="gen"></a>

Connections by SSH keys are authorised at SIMLAB. The procedure for generating keys is described below. When generating your keys, 
you must enter a passphrase to protect your private key. This passphrase will then be requested at each connection or only one time if you 
are using the agent `ssh-aggent`.

The keys are generated by the `ssh-keygen` command. You will be presented with three prompts. We advise you to press `RETURN` for the first prompt 
("Enter file â€¦"). For the second and third prompts, you may enter the passphrase which will protect your keys.

```sh
$ ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (/home/machine-locale/login/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/machine-locale/login/.ssh/id_rsa.
Your public key has been saved in /home/machine-locale/login/.ssh/id_rsa.pub.
The key fingerprint is:
26:e3:d4:29:b7:5b:29:15:d7:68:39:eb:a3:12:0b:02 login@machine-locale.domaine.fr
```

Two files (`id_rsa` and `id_rsa.pub`) are created in the `.ssh` directory of the local machine. Following this, the public key must be added to 
the `authorized_keys` file of the distant machine's `~/.ssh` directory.

### Transferring the file containing your public key to the distant machine <a name="transfert"></a>

The following command should be entered on your local machine. It allows you to transfer the public key into the `authorized_keys` file of the `~/.ssh` directory.
```sh
$ ssh-copy-id <login>@simlab-cluster.um6p.ma 
```

Attention : In order for the key to be recognized, your login only should have write access on the directories of `$HOME` and `$HOME/.ssh` as well as on the 
`$HOME/.ssh/authorized_keys` file. The following is an example of a connection from your local machine to an SIMLAB machine:

```sh
$ ssh -X <login>@simlab-cluster.um6p.ma
Enter passphrase for key '/home/machine-locale/login/.ssh/id_rsa':
```

### Using the ssh-agent program to type your passphrase only one time <a name="use"></a>

- The SSH-agent

You must enter the following two commands on your local machine:

```sh
$ eval 'ssh-agent'
$ ssh-add ~/.ssh/id_rsa
Enter passphrase for /home/machine-locale/login/.ssh/id_rsa:
Identity added: /home/machine-locale/login/.ssh/id_rsa
(/home/machine-locale/login/.ssh/id_rsa)
```

Attention: Connection without entering the passphrase is limited to the lifespan of the agent. You will need to re-launch the agent at each new session.

If you are in a Windows environment and you are using the client `SSH Putty`, you may also use the program `Pageant`, furnished with `Putty`.
